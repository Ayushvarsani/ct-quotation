"use strict";exports.id=959,exports.ids=[959],exports.modules={60959:(e,t,r)=>{r.d(t,{A:()=>y});var a=r(60687),o=r(43210),i=r(66803),s=r(51917),l=r(16184),n=r(44221),d=r(37204),c=r(24296),u=r(90764),p=r(27674),m=r(12064);let h=(0,r(23428).A)((0,a.jsx)("path",{d:"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2zm1-9h1V4H2v1h1zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2zm5-6v2h14V5zm0 14h14v-2H7zm0-6h14v-2H7z"}),"FormatListNumbered");var x=r(26001),g=r(16189),f=r(83236);function y({productId:e,isViewMode:t=!1}){let r=(0,g.useRouter)(),{showSnackbar:y}=(0,f.d)(),[b,v]=(0,o.useState)({}),[_,j]=(0,o.useState)({}),[w,k]=(0,o.useState)(!1),[N,O]=(0,o.useState)(!1),[A,S]=(0,o.useState)({product_name:[],product_size:[]}),[C,E]=(0,o.useState)(!1),[z,$]=(0,o.useState)(null),[U,T]=(0,o.useState)(""),[D,F]=(0,o.useState)({}),H=!!e,[I,L]=(0,o.useState)([]),P=(e,t)=>{v(r=>({...r,[e]:t})),j(t=>({...t,[e]:""}))},M=(e,t)=>{$(e),T(t),E(!0)},V=async()=>{if(z&&U.trim()){if(await W(z,U.trim())){let e=await B(z);S(t=>({...t,[z]:e})),v(e=>({...e,[z]:U.trim()}))}E(!1)}},B=async e=>{let t=localStorage.getItem("user"),r=t?JSON.parse(t):null,a=r?.companyuuid,o=localStorage.getItem("token");if(!a||!o)return[];let i=`/api/protected/${"product_name"===e?"product-name":"product-size"}?company_uuid=${a}`;try{let t=await Object(function(){var e=Error("Cannot find module 'axios'");throw e.code="MODULE_NOT_FOUND",e}())(i,{headers:{"x-auth-token":`Bearer ${o}`}});return t.data?.data?.map(t=>t[e])||[]}catch(t){return console.error(`Failed to fetch ${e} options:`,t),[]}},W=async(e,t)=>{let r=localStorage.getItem("user"),a=r?JSON.parse(r):null,o=a?.companyuuid,i=localStorage.getItem("token");if(!o||!i)return!1;let s=`/api/protected/${"product_name"===e?"product-name":"product-size"}?company_uuid=${o}`;try{return await Object(function(){var e=Error("Cannot find module 'axios'");throw e.code="MODULE_NOT_FOUND",e}())(s,{[e]:t},{headers:{"x-auth-token":`Bearer ${i}`}}),y(`Added new ${e}`,"success",2e3),!0}catch(t){return console.error(`Failed to add ${e}:`,t),y(`Failed to add ${e}`,"error",3e3),!1}},q=async t=>{let r,a=localStorage.getItem("user"),o=a?JSON.parse(a):null,i=o?.companyuuid;if(!i)throw Error("Company UUID not found in localStorage user");let s={product_name:t.product_name,product_category:t.product_category,product_size:t.product_size,product_series:t.product_series,product_finish:t.product_finish,product_pieces_per_box:t.product_pieces_per_box,product_weight:t.product_weight,product_sq_ft_box:t.product_sq_ft_box},l=H?`/api/protected/create-product?product_uuid=${e}`:`/api/protected/create-product?company_uuid=${i}`,n=localStorage.getItem("token");if(!n)throw Error("Token not found in localStorage");if(!(r=H?await Object(function(){var e=Error("Cannot find module 'axios'");throw e.code="MODULE_NOT_FOUND",e}())(l,s,{headers:{"Content-Type":"application/json","x-auth-token":`Bearer ${n}`}}):await Object(function(){var e=Error("Cannot find module 'axios'");throw e.code="MODULE_NOT_FOUND",e}())(l,s,{headers:{"Content-Type":"application/json","x-auth-token":`Bearer ${n}`}})).data||!r.data.status)throw Error(r.data?.message||`Failed to ${H?"update":"create"} product`);return r.data},J=async e=>{e.preventDefault();let t={},a=!1;if(I.forEach(e=>{b[e.key]||(t[e.key]=`${e.label} is required`,a=!0)}),j(t),a)y("Please fix the validation errors","error",4e3);else{k(!0);try{let e=await q(b);e.status?(y(e.msg,"success",3e3),r.push("/user/products"),H||(v({}),F({}))):y(e.msg,"error",3e3)}catch(e){y(e instanceof Error?e.message:"Unexpected error occurred.","error",3e3)}finally{k(!1)}}};return N?(0,a.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,a.jsx)(i.A,{})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 p-4 sm:p-6 lg:p-8",children:(0,a.jsx)("div",{className:"max-w-3xl mx-auto",children:(0,a.jsxs)(x.P.div,{children:[(0,a.jsxs)("button",{type:"button",className:"flex items-center gap-2 text-indigo-600 hover:text-indigo-800 font-semibold mb-4",onClick:()=>r.back(),children:[(0,a.jsx)(m.A,{fontSize:"small"}),"Back"]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl p-6 sm:p-8",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(h,{className:"w-8 h-8 text-white"})}),(0,a.jsx)("h1",{className:"text-2xl sm:text-2xl font-bold text-gray-900 mb-2",children:H?"Edit Product":"Add New Product"})]}),(0,a.jsxs)("form",{onSubmit:J,className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:I.map(e=>{let r="product_name"===e.key||"product_size"===e.key,i=b[e.key]||"",d=(A[e.key]||[]).map(e=>({label:e,value:e}));return(0,a.jsx)("div",{className:"space-y-2",children:r?(0,a.jsx)(s.A,{value:d.find(e=>"value"in e&&e.value===i)||null,onChange:(t,r)=>{r&&"isAddOption"in r&&r.isAddOption?M(e.key,D[e.key]||""):r&&"value"in r?P(e.key,r.value):P(e.key,"")},inputValue:D[e.key]||"",onInputChange:(t,r)=>{F(t=>({...t,[e.key]:r}))},options:d,filterOptions:e=>[...e,{label:"Add",isAddOption:!0}],getOptionLabel:e=>e.label,isOptionEqualToValue:(e,t)=>"value"in e&&"value"in t&&e.value===t.value,disabled:t,renderOption:(e,t)=>(0,o.createElement)("li",{...e,key:t.label},"isAddOption"in t&&t.isAddOption?(0,a.jsx)(l.A,{variant:"outlined",color:"primary",fullWidth:!0,children:t.label}):t.label),renderInput:t=>(0,a.jsx)(n.A,{...t,label:e.label,variant:"outlined",size:"small",error:!!_[e.key],helperText:_[e.key]})}):(0,a.jsx)(n.A,{fullWidth:!0,size:"small",label:e.label,value:i,onChange:t=>P(e.key,t.target.value),error:!!_[e.key],helperText:_[e.key],disabled:t})},e.key)})}),!t&&(0,a.jsxs)("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-3 sm:gap-4 pt-6 sm:pt-8",children:[(0,a.jsx)(x.P.button,{type:"button",onClick:()=>{H?r.back():(v({}),F({}),j({}),y("Form cleared","info",2e3))},whileHover:{scale:1.02},whileTap:{scale:.98},className:"px-4 sm:px-6 py-2.5 sm:py-3 text-sm bg-gray-200 text-gray-700 font-semibold rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-300 transition-all duration-200 shadow-md hover:shadow-lg",children:H?"Cancel":"Clear"}),(0,a.jsx)(x.P.button,{type:"submit",whileHover:{scale:1.02},whileTap:{scale:.98},className:"px-4 sm:px-6 py-2.5 sm:py-3 text-sm bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold rounded-lg hover:from-indigo-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-indigo-300 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-md hover:shadow-lg",disabled:w,children:w?(0,a.jsx)(i.A,{size:22,color:"inherit"}):H?"Update":"Submit"})]})]}),(0,a.jsxs)(d.A,{open:C,onClose:()=>{E(!1),z&&F(e=>({...e,[z]:""}))},fullWidth:!0,maxWidth:"xs",PaperProps:{className:"rounded-2xl",style:{boxShadow:"0 8px 32px rgba(80, 80, 180, 0.15)"}},children:[(0,a.jsxs)(c.A,{className:"font-bold text-indigo-700",children:["Add New ",z?.toUpperCase()]}),(0,a.jsx)(u.A,{children:(0,a.jsx)(n.A,{fullWidth:!0,autoFocus:!0,label:"New Value",value:U,onChange:e=>T(e.target.value),sx:{mt:1}})}),(0,a.jsxs)(p.A,{children:[(0,a.jsx)(l.A,{onClick:()=>{E(!1),z&&F(e=>({...e,[z]:""}))},variant:"outlined",color:"secondary",children:"Cancel"}),(0,a.jsx)(l.A,{onClick:V,variant:"contained",disabled:!U.trim(),sx:{background:"linear-gradient(to right, #6366f1, #a21caf)"},children:"Add"})]})]})]})]})})})}!function(){var e=Error("Cannot find module 'axios'");throw e.code="MODULE_NOT_FOUND",e}()}};